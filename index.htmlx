<!DOCTYPE html>
<html lang="en">
	<head>
		%{indent(BOILERPLATE,levels=2)}
		<title>WQMP</title>
		<!--Load stylesheets after higher priority metadata, we don't need css till the body-->
		<link rel="stylesheet" href="/assets/css/styles.css" />
		<!-- Prefer hosting the files ourselves -->
		<script src="/assets/js/fontawesome.js"></script>
		<script src="/assets/js/chart.js"></script>
		<!--
            here's how to read csv data
            <script %{TS}>
                (async function($ctx) {
                    const csvText = await (await fetch('https://wqmp-server.vercel.app/api/get/SAMPLE-DATA')).text(); // Replace SAMPLE-DATA with device id
                    const data = CSV.parse(csvText);
                    console.log(data);
                    $ctx.replaceWith(
                        <h2>Total Flow: {data.reduce((acc, {flow})=>acc+(+flow), 0).toFixed(2)} gallons</h2> // Due to the TS in the script tag, we can use JSX here
                    );

                })($ctx); // $ctx is the current <script> tag
            </script>
        -->
	</head>
	<body>
		<script src="https://stevebeeblebrox.github.io/assets/js/githubshortcut.min.js?title=Edit&position=top-right&margin=1&href=wqmp/wqmp.github.io/blob/main/index.htmlx"></script>
		<nav class="sidebar">
			<header>
				<div class="image-text">
					<span class="image">
						<img src="assets\icons\maskable_icon.png" alt="wq logo" />
					</span>
					<div class="text header-text">
						<i class="fa-solid fa-font-case">
							<span class="name">Water Quality </span>
							<span class="monitor">Monitor</span>
						</i>
					</div>
				</div>

				<i class="fa-solid fa-chevron-right toggle"></i>
				<script %{TS}>
					$last.$on("click", () => $(".sidebar").classList.toggle("close"));
				</script>
			</header>
			<div class="menu-bar">
				<div class="menu">
					<li class="search-box">
						<i class="fa-solid fa-magnifying-glass icon"></i>
						<input type="search" placeholder="Search..." />
					</li>
					<li class="nav-link">
						<a href="views/dashboard.html" target="page-contents">
							<i class="fa-solid fa-house icon"></i>
							<span class="text nav-text">Dashboard</span>
						</a>
					</li>
					<li class="nav-link">
						<a href="views/usage.html" target="page-contents">
							<i class="fa-solid fa-chart-simple icon"></i>
							<span class="text nav-text">Water Use</span>
						</a>
					</li>
					<li class="nav-link">
						<a href="views/notifications.html" target="page-contents">
							<i class="fa-sharp fa-solid fa-bell icon"></i>
							<span class="text nav-text">Notifications</span>
						</a>
					</li>
					<li class="nav-link">
						<a href="views/settings.html" target="page-contents">
							<i class="fa-solid fa-cog icon"></i>
							<span class="text nav-text">Settings</span>
						</a>
					</li>
					<li class="nav-link" target="page-contents">
						<a href="javascript:App.promptInstall()">
							<i class="fa-solid fa-download icon"></i>
							<span class="text nav-text">Install App</span>
						</a>
					</li>
				</div>
			</div>
		</nav>
		<iframe
			id="page-contents"
			name="page-contents"
			src="views/dashboard.html"
		></iframe>
	</body>
</html>
